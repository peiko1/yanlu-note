2025-12-20 18:18:25.204 [xxl-job, EmbedServer bizThreadPool-418419778] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@161c9468[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:19:58.474 [xxl-job, JobThread-1-1766225905200] INFO  com.xxl.job.core.thread.JobThread - >>>>>>>>>>> xxl-job JobThread stoped, hashCode:Thread[xxl-job, JobThread-1-1766225905200,10,main]
2025-12-20 18:37:22.561 [xxl-job, EmbedServer bizThreadPool-472608369] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@161c9468[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:37:38.167 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 18:37:38.167 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 18:37:38.167 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 18:37:38.168 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 18:37:38.171 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 18:37:38.177 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 18:37:38.207 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 18:37:38.282 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 18:37:50.804 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 18:37:50.808 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 18:37:50.809 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 18:37:50.817 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 18:37:51.587 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 18:37:52.056 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 18:37:52.060 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 18:37:52.088 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 6 ms. Found 0 Redis repository interfaces.
2025-12-20 18:37:52.259 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=aa1cc622-738f-3e0c-891c-0c89c4b13891
2025-12-20 18:37:52.636 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 18:37:52.636 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 18:37:52.639 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 18:37:52.648 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 18:37:52.648 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 18:37:52.741 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 18:37:52.743 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1141 ms
2025-12-20 18:37:52.836 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 18:37:53.172 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 18:37:53.304 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 18:37:53.602 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 18:37:53.602 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 18:37:54.447 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@27e3dc9a[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:37:54.517 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 18:37:54.537 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 18:37:54.537 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 18:37:54.666 [Thread-31] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 18:37:55.412 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 18:37:55.413 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 18:37:55.414 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 18:37:55.414 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 18:37:55.451 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 18:37:55.571 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 5.458 seconds (process running for 6.012)
2025-12-20 18:38:30.638 [xxl-job, EmbedServer bizThreadPool-486697726] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@27e3dc9a[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:38:30.698 [xxl-job, JobThread-1-1766227110638] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 18:38:30.828 [xxl-job, JobThread-1-1766227110638] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 18:38:30.982 [xxl-job, JobThread-1-1766227110638] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 18:40:04.187 [xxl-job, JobThread-1-1766227110638] INFO  com.xxl.job.core.thread.JobThread - >>>>>>>>>>> xxl-job JobThread stoped, hashCode:Thread[xxl-job, JobThread-1-1766227110638,10,main]
2025-12-20 18:48:35.643 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 18:48:35.643 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 18:48:35.643 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 18:48:35.644 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 18:48:35.644 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 18:48:35.644 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 18:48:35.645 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 18:48:35.650 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 18:48:39.972 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 18:48:39.974 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 18:48:39.975 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 18:48:39.981 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 18:48:40.638 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 18:48:41.033 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 18:48:41.035 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 18:48:41.048 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-12-20 18:48:41.148 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=aa1cc622-738f-3e0c-891c-0c89c4b13891
2025-12-20 18:48:41.370 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 18:48:41.370 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 18:48:41.373 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 18:48:41.379 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 18:48:41.380 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 18:48:41.474 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 18:48:41.474 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 826 ms
2025-12-20 18:48:41.537 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 18:48:41.818 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 18:48:41.916 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 18:48:42.103 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 18:48:42.103 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 18:48:42.669 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@2682cccc[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:48:42.734 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 18:48:42.752 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 18:48:42.752 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 18:48:42.864 [Thread-31] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 18:48:43.427 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 18:48:43.429 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 18:48:43.430 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 18:48:43.430 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 18:48:43.474 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 18:48:43.586 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 4.184 seconds (process running for 4.524)
2025-12-20 18:49:03.768 [xxl-job, EmbedServer bizThreadPool-1950544099] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@2682cccc[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 18:49:03.815 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 18:49:03.929 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 18:49:03.938 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 18:49:03.939 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 18:49:03.939 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 18:49:04.022 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 18:49:04.023 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 18:49:04.024 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 18:49:04.086 [xxl-job, JobThread-1-1766227743768] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 18:50:37.304 [xxl-job, JobThread-1-1766227743768] INFO  com.xxl.job.core.thread.JobThread - >>>>>>>>>>> xxl-job JobThread stoped, hashCode:Thread[xxl-job, JobThread-1-1766227743768,10,main]
2025-12-20 20:05:06.654 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 20:05:06.654 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 20:05:06.654 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 20:05:06.657 [Thread-34] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 20:05:06.657 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 20:05:06.658 [Thread-26] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 20:05:06.661 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 20:05:06.675 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 20:05:21.608 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:05:21.612 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:05:21.613 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 20:05:21.620 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 20:05:22.273 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 20:05:22.688 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 20:05:22.689 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 20:05:22.706 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-12-20 20:05:22.900 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=fd78238a-dad4-346f-a3de-751e3c428264
2025-12-20 20:05:23.031 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.033 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.124 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.127 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.129 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.129 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$771/0x0000018a1a4f13e0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.130 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.136 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.137 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:05:23.299 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 20:05:23.299 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 20:05:23.302 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 20:05:23.308 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 20:05:23.308 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 20:05:23.403 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 20:05:23.405 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1117 ms
2025-12-20 20:05:23.714 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 20:05:23.991 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 20:05:25.216 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteCollectTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCollectTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:05:25.216 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteCollectIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-12-20 20:05:26.537 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteLikeTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteLikeTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:05:26.537 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteLikeIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-12-20 20:05:26.543 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 20:05:26.832 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:05:26.832 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:05:27.352 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:05:27.443 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@4411a0fe[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:05:27.532 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 20:05:27.563 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:05:27.563 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:05:27.608 [Thread-33] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 20:05:27.800 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:0
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:05:28.332 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 20:05:28.333 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 20:05:28.334 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 20:05:28.334 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 20:05:28.372 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 20:05:28.503 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 7.394 seconds (process running for 9.027)
2025-12-20 20:05:47.307 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_2] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:05:47.309 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_2] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:1
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:06:00.718 [xxl-job, EmbedServer bizThreadPool-1955530138] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@4411a0fe[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:06:00.776 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:06:00.890 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:06:00.901 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:06:00.903 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:06:00.903 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.001 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.001 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:06:01.002 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.089 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.090 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:06:01.092 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.184 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.184 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:06:01.185 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.260 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.260 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:06:01.261 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.351 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.351 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:06:01.351 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.433 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.433 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:06:01.434 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.443 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.444 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:06:01.444 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.534 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.535 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:06:01.535 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.718 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.718 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:06:01.719 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.827 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.828 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:06:01.828 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.914 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.915 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:06:01.915 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:01.994 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:01.994 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:06:01.996 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.070 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.071 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:06:02.071 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.077 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.078 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:06:02.079 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.157 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.158 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:06:02.159 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.235 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.235 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:06:02.236 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.326 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.328 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:06:02.328 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.445 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.445 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:06:02.446 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.536 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:06:02.537 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:06:02.537 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:06:02.616 [xxl-job, JobThread-1-1766232360718] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:06:16.532 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_3] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:06:16.534 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_3] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:2
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:07:16.455 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_4] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:07:16.458 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_4] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:3
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:07:35.844 [xxl-job, JobThread-1-1766232360718] INFO  com.xxl.job.core.thread.JobThread - >>>>>>>>>>> xxl-job JobThread stoped, hashCode:Thread[xxl-job, JobThread-1-1766232360718,10,main]
2025-12-20 20:09:18.871 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_5] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:09:18.875 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_5] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:4
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:12:16.605 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_6] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:12:16.607 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_6] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:5
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:13:39.819 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 20:13:39.820 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 20:13:39.820 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 20:13:39.820 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 20:13:39.820 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 20:13:39.820 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 20:13:39.821 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 20:13:39.827 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 20:13:44.768 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:13:44.772 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:13:44.773 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 20:13:44.782 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 20:13:45.450 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 20:13:45.887 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 20:13:45.889 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 20:13:45.905 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-12-20 20:13:46.052 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=fd78238a-dad4-346f-a3de-751e3c428264
2025-12-20 20:13:46.179 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.181 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.237 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.240 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.242 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.243 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$783/0x0000023098541628] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.244 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.248 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.249 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:13:46.431 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 20:13:46.433 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 20:13:46.437 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 20:13:46.443 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 20:13:46.443 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 20:13:46.547 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 20:13:46.547 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1080 ms
2025-12-20 20:13:46.804 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 20:13:47.017 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 20:13:48.008 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteCollectTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCollectTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:13:48.008 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteCollectIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-12-20 20:13:48.668 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteLikeTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteLikeTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:13:48.668 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteLikeIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-12-20 20:13:48.672 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 20:13:48.829 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:13:48.829 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:13:49.199 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@57a0aeb8[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:13:49.249 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 20:13:49.261 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:13:49.263 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:13:49.291 [Thread-33] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 20:13:49.748 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 20:13:49.748 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 20:13:49.749 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 20:13:49.749 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 20:13:49.774 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 20:13:49.866 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 5.586 seconds (process running for 6.01)
2025-12-20 20:16:16.379 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:16:16.592 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:6
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:21:18.167 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_2] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:21:18.170 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_2] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:7
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:25:12.975 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 20:25:12.975 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 20:25:12.975 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 20:25:12.975 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 20:25:12.975 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 20:25:12.976 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 20:25:12.977 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 20:25:12.984 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 20:25:18.099 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:25:18.102 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:25:18.102 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 20:25:18.108 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 20:25:18.762 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 20:25:19.143 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 20:25:19.144 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 20:25:19.159 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-12-20 20:25:19.309 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=d74e31bc-fb7e-33d5-b1ff-08ad4956a135
2025-12-20 20:25:19.426 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.427 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.479 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.479 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.480 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.481 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$783/0x0000029b01542358] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.481 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.484 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.485 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:25:19.629 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 20:25:19.630 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 20:25:19.634 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 20:25:19.644 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 20:25:19.644 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 20:25:19.736 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 20:25:19.738 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 965 ms
2025-12-20 20:25:19.995 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 20:25:20.260 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 20:25:21.482 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteCollectTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCollectTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:25:21.483 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteCollectIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-12-20 20:25:22.267 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteLikeTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteLikeTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:25:22.267 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteLikeIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-12-20 20:25:22.283 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 20:25:22.491 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:25:22.491 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:25:22.987 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@6b3da23f[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:25:22.987 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:deleteTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@5058fefb[class com.peikol.xiaohashu.data.align.job.DeleteTableXxlJob$$SpringCGLIB$$0#deleteTableJobHandler]
2025-12-20 20:25:23.070 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 20:25:23.096 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:25:23.096 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:25:23.135 [Thread-33] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 20:25:23.869 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 20:25:23.872 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 20:25:23.873 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 20:25:23.874 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 20:25:23.914 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 20:25:24.039 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 6.495 seconds (process running for 6.991)
2025-12-20 20:27:18.324 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:27:18.561 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] WARN  o.a.r.s.support.DefaultRocketMQListenerContainer - consume message failed. messageId:0A0C2966B32C63947C6B38AEB68A0001, topic:CountNoteLikeTopic, reconsumeTimes:8
java.lang.NullPointerException: Cannot invoke "java.lang.Long.longValue()" because "noteCreatorId" is null
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:81)
	at com.peikol.xiaohashu.data.align.consumer.TodayNoteLikeIncrementData2DBConsumer.onMessage(TodayNoteLikeIncrementData2DBConsumer.java:27)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer.handleMessage(DefaultRocketMQListenerContainer.java:461)
	at org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer$DefaultMessageListenerConcurrently.consumeMessage(DefaultRocketMQListenerContainer.java:421)
	at org.apache.rocketmq.client.impl.consumer.ConsumeMessageConcurrentlyService$ConsumeRequest.run(ConsumeMessageConcurrentlyService.java:411)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:842)
2025-12-20 20:30:48.843 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-12-20 20:30:48.843 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Start destroying ThreadPool
2025-12-20 20:30:48.843 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-12-20 20:30:48.843 [Thread-36] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-12-20 20:30:48.845 [Thread-3] WARN  c.alibaba.nacos.common.executor.ThreadPoolManager - [ThreadPoolManager] Destruction of the end
2025-12-20 20:30:48.845 [Thread-28] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-12-20 20:30:48.845 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-12-20 20:30:48.851 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-12-20 20:30:52.745 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback12.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:30:52.748 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapterBuilder
2025-12-20 20:30:52.748 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter: com.alibaba.nacos.logger.adapter.logback14.LogbackNacosLoggingAdapter match ch.qos.logback.classic.Logger success.
2025-12-20 20:30:52.753 [main] INFO  com.alibaba.nacos.client.logging.NacosLogging - Nacos Logging Adapter Builder: com.alibaba.nacos.logger.adapter.log4j2.Log4j2NacosLoggingAdapterBuilder
2025-12-20 20:30:53.235 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - The following 1 profile is active: "dev"
2025-12-20 20:30:53.540 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-12-20 20:30:53.541 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-12-20 20:30:53.553 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 4 ms. Found 0 Redis repository interfaces.
2025-12-20 20:30:53.663 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=d74e31bc-fb7e-33d5-b1ff-08ad4956a135
2025-12-20 20:30:53.747 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.749 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.792 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.794 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.795 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.796 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$783/0x00000205015413e0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.797 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.800 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.801 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketMQMessageListenerContainerRegistrar' of type [org.apache.rocketmq.spring.support.RocketMQMessageListenerContainerRegistrar] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-12-20 20:30:53.908 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8091 (http)
2025-12-20 20:30:53.909 [main] INFO  org.apache.catalina.core.AprLifecycleListener - Loaded Apache Tomcat Native library [2.0.8] using APR version [1.7.4].
2025-12-20 20:30:53.911 [main] INFO  org.apache.catalina.core.AprLifecycleListener - OpenSSL successfully initialized [OpenSSL 3.0.14 4 Jun 2024]
2025-12-20 20:30:53.916 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-12-20 20:30:53.916 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-12-20 20:30:53.988 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-12-20 20:30:53.988 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 745 ms
2025-12-20 20:30:54.219 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-12-20 20:30:54.420 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-12-20 20:30:55.354 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteCollectTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCollectTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:30:55.355 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteCollectIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-12-20 20:30:56.015 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_data_align_CountNoteLikeTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteLikeTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-12-20 20:30:56.015 [main] INFO  o.a.r.s.s.RocketMQMessageListenerContainerRegistrar - Register the listener to container, listenerBeanName:todayNoteLikeIncrementData2DBConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-12-20 20:30:56.029 [main] INFO  c.peikol.xiaohashu.data.align.config.XxlJobConfig - >>>>>>>>>>> xxl-job config init.
2025-12-20 20:30:56.207 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:30:56.207 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:30:56.583 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:createTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@65871cfd[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:30:56.583 [main] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job register jobhandler success, name:deleteTableJobHandler, jobHandler:com.xxl.job.core.handler.impl.MethodJobHandler@3bdc8975[class com.peikol.xiaohashu.data.align.job.DeleteTableXxlJob$$SpringCGLIB$$0#deleteTableJobHandler]
2025-12-20 20:30:56.635 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8091 (http) with context path ''
2025-12-20 20:30:56.650 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-12-20 20:30:56.650 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-12-20 20:30:56.680 [Thread-33] INFO  com.xxl.job.core.server.EmbedServer - >>>>>>>>>>> xxl-job remoting server start success, nettype = class com.xxl.job.core.server.EmbedServer, port = 10001
2025-12-20 20:30:57.152 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to get current node abilities...
2025-12-20 20:30:57.152 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Ready to initialize current node abilities, support modes: [SDK_CLIENT]
2025-12-20 20:30:57.153 [main] INFO  c.a.n.common.ability.AbstractAbilityControlManager - Initialize current abilities finish...
2025-12-20 20:30:57.153 [main] INFO  c.a.n.c.ability.discover.NacosAbilityManagerHolder - [AbilityControlManager] Successfully initialize AbilityControlManager
2025-12-20 20:30:57.179 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-data-align 10.12.41.102:8091 register finished
2025-12-20 20:30:57.278 [main] INFO  c.p.x.data.align.XiaohashuDataAlignApplication - Started XiaohashuDataAlignApplication in 4.974 seconds (process running for 5.378)
2025-12-20 20:32:31.369 [xxl-job, EmbedServer bizThreadPool-595172166] INFO  com.xxl.job.core.executor.XxlJobExecutor - >>>>>>>>>>> xxl-job regist JobThread success, jobId:1, handler:com.xxl.job.core.handler.impl.MethodJobHandler@65871cfd[class com.peikol.xiaohashu.data.align.job.CreateTableXxlJob#createTableJobHandler]
2025-12-20 20:32:31.430 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:32:31.554 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.567 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.567 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:32:31.568 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.577 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.579 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:32:31.580 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.589 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.589 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:32:31.589 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.597 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.597 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:32:31.597 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.605 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.606 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:32:31.607 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.614 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.615 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_0` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:32:31.616 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.624 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.625 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:32:31.626 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.630 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.631 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:32:31.632 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.638 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.639 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:32:31.639 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.647 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.647 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:32:31.648 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.655 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.656 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:32:31.656 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.662 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.662 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:32:31.663 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.669 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.669 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_1` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:32:31.669 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.676 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.676 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_following_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：关注数';
2025-12-20 20:32:31.677 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.682 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFollowingCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.682 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_fans_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：粉丝数';
2025-12-20 20:32:31.683 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.689 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignFansCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.690 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_collect_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得收藏数';
2025-12-20 20:32:31.690 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.696 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.696 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_collect_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得收藏数';
2025-12-20 20:32:31.697 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.704 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserCollectCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.704 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_user_like_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `user_id` bigint unsigned NOT NULL COMMENT '用户ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_user_id` (`user_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户获得点赞数';
2025-12-20 20:32:31.705 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.711 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignUserLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.712 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_like_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：笔记获得点赞数';
2025-12-20 20:32:31.712 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.720 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNoteLikeCountTempTable - <==    Updates: 0
2025-12-20 20:32:31.720 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==>  Preparing: CREATE TABLE IF NOT EXISTS `t_data_align_note_publish_count_temp_20251221_2` ( `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID', `note_id` bigint unsigned NOT NULL COMMENT '笔记ID', PRIMARY KEY (`id`) USING BTREE, UNIQUE KEY `uk_note_id` (`note_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据对齐日增量表：用户发布笔记数';
2025-12-20 20:32:31.720 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - ==> Parameters: 
2025-12-20 20:32:31.731 [xxl-job, JobThread-1-1766233951369] DEBUG c.p.x.d.a.d.m.C.createDataAlignNotePublishCountTempTable - <==    Updates: 0
2025-12-20 20:34:05.001 [xxl-job, JobThread-1-1766233951369] INFO  com.xxl.job.core.thread.JobThread - >>>>>>>>>>> xxl-job JobThread stoped, hashCode:Thread[xxl-job, JobThread-1-1766233951369,10,main]
2025-12-20 20:34:19.633 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] INFO  c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - ## TodayNoteLikeIncrementData2DBConsumer 消费到了 MQ: {"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
2025-12-20 20:34:19.642 [ConsumeMessageThread_xiaohashu_group_data_align_CountNoteLikeTopic_1] ERROR c.p.x.d.a.c.TodayNoteLikeIncrementData2DBConsumer - Invalid MQ message, missing required fields, body={"userId":1,"noteId":1996553589358592026,"type":1,"createTime":[2025,12,12,0,9,5,537657200]}
